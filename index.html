<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<title>Saturday Decider</title>

<style>
  :root{
    --text:#0b1220;
    --muted: rgba(11,18,32,.62);

    /* Glass tuning */
    --glassA: rgba(255,255,255,.78);
    --glassB: rgba(255,255,255,.62);
    --stroke: rgba(255,255,255,.28);
    --stroke2: rgba(11,18,32,.12);
    --shadow: 0 26px 80px rgba(3, 10, 24, .22);

    --r: 30px;
    --ease: cubic-bezier(.16,1,.3,1);

    /* Button */
    --btnA:#0ea5e9;
    --btnB:#2563eb;
    --btnText:#ffffff;

    /* Tab gradients (bold) */
    --t0a:#0b4fe3; --t0b:#45b8ff;
    --t1a:#6d28d9; --t1b:#1d4ed8;
    --t2a:#059669; --t2b:#22c55e;
    --t3a:#db2777; --t3b:#fb7185;
    --t4a:#0ea5e9; --t4b:#14b8a6;
  }

  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{height:100%}

  body{
    margin:0;
    font-family: -apple-system, system-ui, "SF Pro Display", Segoe UI, Roboto, Arial, sans-serif;
    color: var(--text);
    overflow:hidden;
    background: linear-gradient(135deg, var(--t0a), var(--t0b));
    transition: background .9s var(--ease);
  }

  /* ===== Animated background blobs ===== */
  .bg{
    position:fixed; inset:0; z-index:-2; overflow:hidden;
  }
  .blob{
    position:absolute;
    width: 520px; height: 520px;
    border-radius: 999px;
    filter: blur(48px);
    opacity: .55;
    transform: translate3d(0,0,0);
    animation: float 16s var(--ease) infinite alternate;
  }
  .b1{ left:-180px; top:-160px; background: rgba(255,255,255,.22); }
  .b2{ right:-220px; bottom:-220px; background: rgba(255,255,255,.18); animation-duration: 18s; }
  .b3{ left: 10%; bottom:-240px; background: rgba(255,255,255,.14); animation-duration: 20s; }
  @keyframes float{
    from{ transform: translate3d(-10px, 0px, 0) scale(1); }
    to  { transform: translate3d(80px, 50px, 0) scale(1.08); }
  }

  /* ===== Noise overlay (makes glass feel real) ===== */
  .noise{
    position:fixed; inset:0; z-index:-1; pointer-events:none;
    background-image:url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" width="220" height="220">\
<filter id="n"><feTurbulence type="fractalNoise" baseFrequency=".85" numOctaves="3" stitchTiles="stitch"/></filter>\
<rect width="220" height="220" filter="url(%23n)" opacity=".38"/></svg>');
    mix-blend-mode: overlay;
    opacity:.085;
  }

  /* ===== Header ===== */
  header{
    padding: calc(env(safe-area-inset-top) + 18px) 18px 10px;
    display:flex;
    justify-content:space-between;
    align-items:flex-end;
    gap: 12px;
  }
  .hdr-left{display:flex;flex-direction:column;gap:4px}
  .hdr-title{
    font-weight: 900;
    letter-spacing: .5px;
    color: rgba(255,255,255,.95);
    font-size: 13px;
    text-transform: uppercase;
  }
  .hdr-sub{
    font-size: 12px;
    color: rgba(255,255,255,.78);
  }

  /* Only for my Pastel ‚Äî deep blue + animated shine */
  .hdr-right{
    font-size:12px;
    font-weight: 900;
    letter-spacing: .2px;
    color: #0b3aa6;
    position:relative;
    padding: 8px 12px;
    border-radius: 999px;
    background: rgba(255,255,255,.72);
    border: 1px solid rgba(255,255,255,.55);
    box-shadow: 0 14px 40px rgba(0,0,0,.18);
    overflow:hidden;
  }
  .hdr-right::before{
    content:"";
    position:absolute; inset:-40%;
    background: conic-gradient(from 180deg,
      rgba(255,255,255,0),
      rgba(255,255,255,.8),
      rgba(255,255,255,0)
    );
    animation: shine 2.8s linear infinite;
    opacity:.55;
  }
  .hdr-right span{ position:relative; z-index:1; }
  @keyframes shine{ to{ transform: rotate(360deg); } }

  /* ===== Main layout ===== */
  main{
    height: calc(100% - 82px);
    padding: 14px;
    display:grid;
    place-items:center;
  }
  .container{
    width: 100%;
    max-width: 400px;
    height: 100%;
    position: relative;
  }

  /* ===== Tabs ===== */
  .tab{
    position:absolute; inset:0;
    display:flex;
    opacity:0;
    transform: translateY(18px) scale(.98);
    pointer-events:none;
    transition: opacity .5s var(--ease), transform .6s var(--ease);
  }
  .tab.active{
    opacity:1;
    transform: translateY(0) scale(1);
    pointer-events:auto;
  }

  /* ===== Glass card (stronger, modern) ===== */
  .card{
    width:100%;
    height:100%;
    border-radius: var(--r);
    padding: 26px 22px;
    background:
      linear-gradient(180deg, var(--glassA), var(--glassB));
    border: 1px solid var(--stroke);
    box-shadow: var(--shadow);
    backdrop-filter: blur(22px) saturate(1.25);
    -webkit-backdrop-filter: blur(22px) saturate(1.25);
    position: relative;
    overflow:hidden;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
  }
  /* subtle inner highlight + edge gradient */
  .card::before{
    content:"";
    position:absolute; inset:0;
    background:
      radial-gradient(900px 400px at 20% 10%, rgba(255,255,255,.55), transparent 55%),
      radial-gradient(700px 380px at 90% 30%, rgba(255,255,255,.35), transparent 55%);
    opacity:.35;
    pointer-events:none;
  }
  .card::after{
    content:"";
    position:absolute; inset: 0;
    border-radius: var(--r);
    border: 1px solid rgba(11,18,32,.10);
    pointer-events:none;
  }

  h1{
    margin:0 0 10px;
    font-size: 28px;
    letter-spacing: -0.8px;
    text-align:center;
  }
  p{
    margin:0 0 22px;
    font-size: 15px;
    line-height:1.7;
    color: var(--muted);
    text-align:center;
    max-width: 32ch;
  }

  /* ===== Buttons (consistent + shimmer + ripple) ===== */
  .btnRow{ width:100%; display:flex; flex-direction:column; gap:10px; }
  .btn{
    width:100%;
    padding: 15px 16px;
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,.35);
    background: linear-gradient(135deg, var(--btnA), var(--btnB));
    color: var(--btnText);
    font-weight: 900;
    font-size: 15px;
    cursor:pointer;
    position:relative;
    overflow:hidden;
    box-shadow: 0 18px 40px rgba(2, 30, 90, .25);
    transition: transform .15s var(--ease), filter .2s var(--ease);
  }
  .btn:hover{ filter: brightness(1.03); }
  .btn:active{ transform: scale(.98); }

  /* shimmer */
  .btn::before{
    content:"";
    position:absolute; inset:-40%;
    background: linear-gradient(90deg,
      rgba(255,255,255,0),
      rgba(255,255,255,.55),
      rgba(255,255,255,0)
    );
    transform: translateX(-60%);
    animation: shimmer 3.2s var(--ease) infinite;
    opacity:.6;
  }
  @keyframes shimmer{
    0%{ transform: translateX(-70%) rotate(12deg); }
    55%{ transform: translateX(70%) rotate(12deg); }
    100%{ transform: translateX(70%) rotate(12deg); }
  }

  /* ripple on click */
  .ripple{
    position:absolute; border-radius:50%;
    transform: scale(0);
    animation: ripple .6s linear;
    background: rgba(255,255,255,.55);
    pointer-events:none;
  }
  @keyframes ripple{
    to{ transform: scale(18); opacity:0; }
  }

  .btn-ghost{
    width:100%;
    padding: 14px 16px;
    border-radius: 18px;
    background: rgba(255,255,255,.62);
    border: 1px solid rgba(11,18,32,.10);
    color: rgba(11,18,32,.92);
    font-weight: 900;
    font-size: 14px;
    cursor:pointer;
    transition: transform .15s var(--ease);
  }
  .btn-ghost:active{ transform: scale(.98); }

  /* ===== Plan (scrollable) ===== */
  .plan-wrap{
    width:100%;
    height:100%;
    display:flex;
    flex-direction:column;
    align-items:stretch;
    justify-content:flex-start;
  }
  .planTop{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:10px;
    margin-bottom: 10px;
    position:relative;
    z-index:1;
  }
  .planTitle{
    font-size: 22px;
    font-weight: 1000;
    margin:0;
    letter-spacing:-.4px;
  }
  .planMeta{
    font-size: 12px;
    color: var(--muted);
    margin: 2px 0 0;
  }
  .toast{
    position:absolute;
    left:50%;
    top: 12px;
    transform: translateX(-50%) translateY(-10px);
    background: rgba(255,255,255,.85);
    border: 1px solid rgba(11,18,32,.10);
    color: rgba(11,18,32,.92);
    padding: 8px 12px;
    border-radius: 999px;
    font-size: 12px;
    font-weight: 900;
    opacity: 0;
    transition: opacity .35s var(--ease), transform .35s var(--ease);
    z-index:3;
  }
  .toast.show{
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  .timeline{
    flex:1;
    overflow-y:auto;
    padding-right: 4px;
    margin-top: 8px;
    position:relative;
    z-index:1;
  }
  .slot{
    display:flex;
    gap:12px;
    padding: 12px 14px;
    border-radius: 16px;
    background: rgba(255,255,255,.92);
    border: 1px solid rgba(11,18,32,.10);
    box-shadow: 0 10px 24px rgba(3,10,24,.06);
    margin-bottom: 10px;
  }
  .time{
    min-width: 70px;
    font-weight: 1000;
    font-size: 11px;
    color: rgba(11,18,32,.88);
  }
  .act{
    font-size: 13px;
    color: rgba(11,18,32,.78);
    line-height:1.5;
  }

  /* ===== Nav dots ===== */
  nav{
    position:fixed;
    bottom:calc(env(safe-area-inset-bottom) + 18px);
    left:50%;
    transform: translateX(-50%);
    display:flex;
    gap:10px;
    z-index:5;
  }
  .dot{
    width:6px; height:6px; border-radius:50%;
    background: rgba(255,255,255,.55);
    transition:.4s;
  }
  .dot.active{
    width:24px;
    border-radius: 10px;
    background:#fff;
  }

  /* ===== FX canvas ===== */
  canvas#fx{
    position:fixed; inset:0;
    pointer-events:none;
    z-index: 50;
  }
</style>
</head>

<body>
  <div class="bg" aria-hidden="true">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>
  </div>
  <div class="noise" aria-hidden="true"></div>
  <canvas id="fx"></canvas>

  <header>
    <div class="hdr-left">
      <div class="hdr-title">Saturday Decider</div>
      <div class="hdr-sub" id="dateTxt"></div>
    </div>
    <div class="hdr-right"><span>M·ªôt s·∫£n ph·∫©m d√†nh ri√™ng cho v·ª£ t√¥i üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë©</span></div>
  </header>

  <main>
    <div class="container">
      <!-- TAB 0 -->
      <section class="tab active" id="t0">
        <div class="card">
          <div style="font-size:38px;margin-bottom:12px;position:relative;z-index:1;">üíô</div>
          <h1 style="position:relative;z-index:1;">Bello my babyyyyy.</h1>
          <p style="position:relative;z-index:1;">
            Mai ƒë√£ l√† th·ª© B·∫£y tuy·ªát v·ªùi r·ªìi.  
            T·ª•i m√¨nh ng·ªß n∆∞·ªõng m·ªôt x√≠u. R·ªìi d·∫≠y "y√™u nhau".üíÉ
            Xong pick m·ªôt chi·∫øc plan cho c·∫£ ng√†y nh√©!
          </p>
          <div class="btnRow" style="position:relative;z-index:1;">
            <button class="btn" data-ripple onclick="go(1, true)">Okay? Go!</button>
          </div>
        </div>
      </section>

      <!-- TAB 1 -->
      <section class="tab" id="t1">
        <div class="card">
          <div style="font-size:36px;margin-bottom:12px;position:relative;z-index:1;">üå§Ô∏è</div>
          <h1 style="position:relative;z-index:1;">∆Øu ti√™n h√†ng ƒë·∫ßu: KH√îNG d·∫≠y s·ªõm! </h1>
          <p style="position:relative;z-index:1;">
            T·ª•i m√¨nh c√≥ th·ªÉ d·∫≠y t·∫ßm <b>9-10h</b> g√¨ ƒë·∫•y.  
            Kh√¥ng c·∫ßn v·ªôi hay FOMO.  
            C·ª© go with the flow thoy nh√© em b√©.üíÖ
          </p>
          <div class="btnRow" style="position:relative;z-index:1;">
            <button class="btn" data-ripple onclick="go(2, true)">Okkk, ch∆°i ti·∫øp n√†o!</button>
            <button class="btn-ghost" onclick="go(0, true)">Quay l·∫°i</button>
          </div>
        </div>
      </section>

      <!-- TAB 2 -->
      <section class="tab" id="t2">
        <div class="card">
          <div style="font-size:36px;margin-bottom:12px;position:relative;z-index:1;">ü´∂</div>
          <h1 style="position:relative;z-index:1;">D-Day‚Äôs mood</h1>
          <p style="position:relative;z-index:1;">
            L·ª±a ch·ªçn ƒë∆°n gi·∫£n, nhanh g·ªçn, ∆∞u ti√™n v·ª£ iu. Ch·ªã y√™u em nhi·ªÅu nh·∫Øm! üíïü¶ñ.  
            Quan tr·ªçng l√† d√†nh th·ªùi gian vui v·∫ª v·ªõi nhau, kh√¥ng c·∫ßn ch·∫°y show h√© he.
          </p>
          <div class="btnRow" style="position:relative;z-index:1;">
            <button class="btn" data-ripple onclick="go(3, true)">B·∫Øt ƒë·∫ßu nh·ªâ!</button>
            <button class="btn-ghost" onclick="go(1, true)">Hay ng√≥ l·∫°i slide c≈©?</button>
          </div>
        </div>
      </section>

      <!-- TAB 3 -->
      <section class="tab" id="t3">
        <div class="card">
          <div style="font-size:36px;margin-bottom:12px;position:relative;z-index:1;">üé≤</div>
          <h1 style="position:relative;z-index:1;">Home or out?</h1>
          <p style="position:relative;z-index:1;">
            C√°i n√†o c≈©ng ƒë∆∞·ª£c.  
            C√≥ em l√† ƒë∆∞·ª£c.üåπ
          </p>
          <div class="btnRow" style="position:relative;z-index:1;">
            <button class="btn" data-ripple onclick="decide()">Ch·ªçn l·ª•i thoy!</button>
            <button class="btn-ghost" onclick="go(2, true)">Quay d√¨a?</button>
          </div>
        </div>
      </section>

      <!-- TAB 4 -->
      <section class="tab" id="t4">
        <div class="card">
          <div class="toast" id="toast">Yay üíô! D√≠nh k√®o r√≤i</div>

          <div class="plan-wrap" style="position:relative;z-index:1;">
            <div class="planTop">
              <div>
                <h2 class="planTitle" id="planTitle">‚Äî</h2>
                <div class="planMeta" id="planMeta">Full-day plan ‚Ä¢ ch·∫≠m r√£i ‚Ä¢ tho·∫£i m√°i</div>
              </div>
            </div>

            <div class="timeline" id="timeline"></div>

            <div class="btnRow" style="margin-top:10px;">
              <button class="btn" data-ripple onclick="reroll()">Ch·ªçn l·∫°i? (h·ªã h·ªã) üòå</button>
              <button class="btn-ghost" onclick="go(3, true)">L·ªôn ng∆∞·ª£c v·ªÅ 1 t√≠</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <nav aria-hidden="true">
    <div class="dot active"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
  </nav>

<script>
  // ===== Tabs + Theme switching (bold gradients) =====
  const tabs = [...document.querySelectorAll('.tab')];
  const dots = [...document.querySelectorAll('.dot')];
  const body = document.body;

  const themes = [
    ['var(--t0a)','var(--t0b)'],
    ['var(--t1a)','var(--t1b)'],
    ['var(--t2a)','var(--t2b)'],
    ['var(--t3a)','var(--t3b)'],
    ['var(--t4a)','var(--t4b)'],
  ];

  function go(i, smooth){
    tabs.forEach(t=>t.classList.remove('active'));
    dots.forEach(d=>d.classList.remove('active'));
    tabs[i].classList.add('active');
    dots[i].classList.add('active');
    body.style.background = `linear-gradient(135deg, ${themes[i][0]}, ${themes[i][1]})`;
    if (smooth) window.scrollTo({top:0, behavior:'smooth'});
  }

  document.getElementById('dateTxt').textContent =
    new Date().toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'});

  // ===== Plans (updated per your request) =====
  const OPTIONS = [
    {
      key: "home",
      name: "Stay-Home Date üè†",
      meta: "steak by me ‚Ä¢ netflix + bia b·ªçt r·ª• ch√® ‚Ä¢ soul-share",
      plan: [
        ["10:00","Ng·ªß n∆∞·ªõng m·ªôt ch√∫t. üí§ Cuddleeeeee."],
        ["10:45","Order cho l·∫π, l√¢u l√¢u l∆∞·ªùi bi·∫øng c≈©ng kh√¥ng sao ü§ü"],
        ["12:30","Ch·ªã mu·ªën v·∫Ω v·ªùi ho·∫∑c x·∫øp h√¨nh n·∫∑n ƒë·∫•t s√©t g√¨ ƒë√≥ v·ªõi b√©"],
        ["15:00","ƒê·ªçc s√°ch + nghe nh·∫°c t√≠ üìö"],
        ["18:30","Ch·ªã n·∫•u steak, em ƒëi loanh quanh ch∆°i c√πng nh√© üòå"],
        ["21:45","Netflix + m√≥n g√¨ ƒë√≥ v·ª£ em mix, n·∫øu mu·ªën say th√¨ l√†m ngay ƒë√™m nayüç∏"],
        ["23:30","T√¢m s·ª± x√≠u, hohoo.üí¶ √ù ch·ªã l√† t√¢m s·ª± ;)"],
        ["0:45","Ng·ªß s·ªõm cho ƒë·∫πp da."]
      ]
    },
    {
      key: "out",
      name: "Out Date üèôÔ∏è",
      meta: "brunch qu·∫≠n 2 ‚Ä¢ cafe ƒë·ªçc s√°ch ‚Ä¢ shopping r·ªìi night dating",
      plan: [
        ["09:30","D·∫≠y s·ªõm h∆°n t√≠ nh∆∞ng PH·∫¢I cuddleeee.üíãüíã"],
        ["10:30","Chu·∫©n b·ªã qu·∫ßn √°o l·ª•a l√†, Êàë‰ª¨ÊÖ¢ÊÖ¢Êù•„ÄÇü§∏"],
        ["12:00","Brunch (ƒë√¢u ƒë√≥ ·ªü qu·∫≠n 2?)."],
        ["14:00","Cafe ƒë·ªçc s√°ch? I think so~"],
        ["15:30","Shopping qu·∫≠n 1, b·∫•t c·ª© ƒë√¢u em b√© th√≠ch."],
        ["17:30","Dinner brainstormmmmüß†. Ho·∫∑c h·ªèi tiktok cho l·∫π :)"],
        ["18:30","ƒÇn t·ªëi r·ªìi suy nghƒ© xem ƒëi ƒë√¢u ti·∫øp hay v·ªÅ nh√† √¥m nhau?"],
        ["23:30","HOME! T·∫Øm t√°p th∆°m tho r·ªìi √¥m nhau t√¢m s·ª±!!!üòà"]
      ],
      eats: [
        "Brunch ideas (D2): RAUM, Livannah, I hate Monday,... ",
        "Dinner picks (D1): Cee's Eatery, Saigon M·∫°ch, Elgin Saigon,...",
        "N·∫øu em mu·ªën ƒÉn steak th√¨ m√¨nh c√≥ th·ªÉ ƒë·∫øn c√°i qu√°n l·∫ßn ƒë·∫ßu m√¨nh ƒëi, qu√°n ƒë·ªì ƒÉn ngon nh∆∞ng nh·∫°c d·ªü t·ªá √≠?üé∫"
      ]
    }
  ];

  let current = null;

  function renderPlan(opt){
    document.getElementById('planTitle').textContent = opt.name;
    document.getElementById('planMeta').textContent = opt.meta;

    const tl = document.getElementById('timeline');
    tl.innerHTML = opt.plan.map(([t,a])=>`
      <div class="slot">
        <div class="time">${t}</div>
        <div class="act">${a}</div>
      </div>
    `).join("");

    // If out-date, append restaurant notes (not too long)
    if(opt.key === "out"){
      const note = document.createElement('div');
      note.className = 'slot';
      note.innerHTML = `
        <div class="time">Food</div>
        <div class="act">
          <b>Brunch (D2)</b>: RAUM, Livannah, I hate Monday <br/>
          <b>Romantic dinner</b>: Cee's Eatery, Saigon M·∫°ch, Elgin Saigon <br/>
          <span style="opacity:.8">Tip: ch·ªçn ƒë·∫°i ƒë·∫°i 2 c√°i, r·ªìi t√πy mood m√† ch·ªçn l·∫°i =)).</span>
        </div>`;
      tl.appendChild(note);
    }
  }

  // ===== Celebration FX (hearts + confetti) =====
  const fx = document.getElementById('fx');
  const ctx = fx.getContext('2d');
  let W=0,H=0, particles=[];
  function resize(){
    W = fx.width = window.innerWidth;
    H = fx.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  function spawnCelebration(){
    const count = 140;
    for(let i=0;i<count;i++){
      const isHeart = Math.random() < 0.55;
      particles.push({
        x: W*0.2 + Math.random()*W*0.6,
        y: H*0.62 + Math.random()*20,
        vx: (-1.3 + Math.random()*2.6),
        vy: (-6.5 - Math.random()*6.5),
        g: 0.12 + Math.random()*0.10,
        life: 90 + Math.random()*70,
        r: 4 + Math.random()*6,
        rot: Math.random()*Math.PI*2,
        vr: (-0.15 + Math.random()*0.3),
        kind: isHeart ? "heart" : "confetti",
        hue: isHeart ? (330 + Math.random()*30) : (200 + Math.random()*80)
      });
    }
    tickFX();
  }

  function drawHeart(x,y,s,rot,alpha,hue){
    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(rot);
    ctx.globalAlpha = alpha;
    ctx.fillStyle = `hsla(${hue}, 85%, 65%, ${alpha})`;
    ctx.beginPath();
    // simple heart param
    const k = s;
    ctx.moveTo(0, k*0.35);
    ctx.bezierCurveTo(0, -k*0.35, -k, -k*0.05, 0, k);
    ctx.bezierCurveTo(k, -k*0.05, 0, -k*0.35, 0, k*0.35);
    ctx.closePath();
    ctx.fill();
    ctx.restore();
  }

  let running=false;
  function tickFX(){
    if(running) return;
    running = true;
    (function loop(){
      ctx.clearRect(0,0,W,H);
      particles = particles.filter(p => p.life-- > 0);

      for(const p of particles){
        p.x += p.vx;
        p.y += p.vy;
        p.vy += p.g;
        p.rot += p.vr;

        const alpha = Math.max(0, Math.min(1, p.life/120));

        if(p.kind === "heart"){
          drawHeart(p.x, p.y, p.r, p.rot, alpha, p.hue);
        }else{
          ctx.save();
          ctx.translate(p.x,p.y);
          ctx.rotate(p.rot);
          ctx.globalAlpha = alpha;
          ctx.fillStyle = `hsla(${p.hue}, 85%, 62%, ${alpha})`;
          ctx.fillRect(-p.r, -p.r*0.35, p.r*2.2, p.r*0.7);
          ctx.restore();
        }
      }

      if(particles.length>0){
        requestAnimationFrame(loop);
      }else{
        running=false;
      }
    })();
  }

  function toast(msg){
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(()=>t.classList.remove('show'), 1700);
  }

  // ===== Decide + Reroll =====
  function pickOne(){
    return OPTIONS[Math.floor(Math.random()*OPTIONS.length)];
  }

  function decide(){
    current = pickOne();
    renderPlan(current);
    go(4, true);

    // celebrate on result tab
    toast(`Yay üíô ‚Äî ${current.key === "home" ? "home date" : "out date"} picked r·ªìi nh√©`);
    spawnCelebration();
  }

  function reroll(){
    current = pickOne();
    renderPlan(current);
    toast("Okay okay‚Ä¶ one more spin üòå");
    spawnCelebration();
  }

  // ===== Button ripple wiring =====
  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-ripple]');
    if(!btn) return;
    const rect = btn.getBoundingClientRect();
    const s = Math.max(rect.width, rect.height);
    const ripple = document.createElement('span');
    ripple.className = 'ripple';
    ripple.style.width = ripple.style.height = s + "px";
    ripple.style.left = (e.clientX - rect.left - s/2) + "px";
    ripple.style.top  = (e.clientY - rect.top  - s/2) + "px";
    btn.appendChild(ripple);
    setTimeout(()=> ripple.remove(), 650);
  });
</script>
</body>
</html>
